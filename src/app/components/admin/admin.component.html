<p-toast></p-toast>
<div class="container">
    <div class="row">
        <h3 class="m-0">إدارة المستخدمين</h3>
    </div>
    <div class="card">
        <p-toolbar styleClass="mb-4">
            <ng-template pTemplate="right">
                <button pButton pRipple label="جديد" icon="pi pi-plus" class="p-button-success mr-2"
                    (click)="newAccount()"></button>&nbsp;&nbsp;
                <button pButton pRipple label="حذف" icon="pi pi-trash" class="p-button-danger"
                    (click)="deleteSelectedProducts()"
                    [disabled]="!selectedAccounts || !selectedAccounts.length"></button>
            </ng-template>
        </p-toolbar>

        <p-table dir="rtl" #dt [value]="accounts" [rows]="10" [paginator]="true" [globalFilterFields]="[
        'User_ID',
        'User_First_FirstName',
        'User_First_LastName',
        'User_Name',
        'Collage_FK',
        'User_Type'
      ]" responsiveLayout="scroll" [(selection)]="selectedAccounts" [rowHover]="true" dataKey="id"
            currentPageReportTemplate="اظهار {first} من {last}" [showCurrentPageReport]="true">
            <ng-template pTemplate="caption">
                <div class="flex align-items-center justify-content-between">
                    <span class="p-input-icon-right">
                        <i class="pi pi-search"></i>
                        <input pInputText type="text" placeholder=" بحث حسب الاسم..." />
                    </span>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th style="width: 3rem">
                        <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
                    </th>
                    <th pSortableColumn="User_First_FirstName">
                        الاسم <p-sortIcon field="User_First_FirstName"></p-sortIcon>
                    </th>
                    <th pSortableColumn="User_Name">
                        اسم المستخدم<p-sortIcon field="User_Name"></p-sortIcon>
                    </th>
                    <th>كلمة المرور</th>
                    <th pSortableColumn="Collage_FK">
                        رمز الجامعة<p-sortIcon field="Collage_FK"></p-sortIcon>
                    </th>
                    <th pSortableColumn="User_Type">
                        نوع المستخدم<p-sortIcon field="User_Type"></p-sortIcon>
                    </th>
                    <th></th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-account>
                <tr>
                    <td style="width: 3rem">
                        <p-tableCheckbox [value]="account"></p-tableCheckbox>
                    </td>
                    <td>
                        {{ account.User_First_FirstName }} {{ account.User_First_LastName }}
                    </td>
                    <td>{{ account.User_Name }}</td>
                    <td>{{ account.User_Password }}</td>
                    <td>{{ account.Collage_FK }}</td>
                    <td>{{ account.User_Type }}</td>
                    <td>
                        <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-warning mr-2"
                            (click)="editAccount(account)"></button> &nbsp;
                        <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-danger"
                            (click)="deleteAccount(account)"></button>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="summary">
                <div class="flex align-items-center justify-content-between">
                    <p>لديك اجمالي {{ accounts ? accounts.length : 0 }} مستخدم</p>
                </div>
            </ng-template>
        </p-table>
    </div>
</div>

<p-dialog [(visible)]="accountDialog" [style]="{ width: '450px' }" header="تفاصيل الحساب" [modal]="true"
    styleClass="p-fluid">
    <ng-template pTemplate="content" style="text-align: right" dir="rtl">
        <div class="field">
            <label for="name">الاسم الاول</label>
            <input type="text" pInputText id="name" [(ngModel)]="account.User_First_FirstName" required autofocus />
            <small class="p-error" *ngIf="submitted && !account.User_First_FirstName">الاسم الاول مطلوب</small>
        </div>
        <div class="field">
            <label for="name">الاسم الاخير</label>
            <input type="text" pInputText id="name" [(ngModel)]="account.User_First_LastName" required autofocus />
            <small class="p-error" *ngIf="submitted && !account.User_First_LastName">الاسم الاخير مطلوب</small>
        </div>
        <div class="field">
            <label for="name">اسم المستخدم</label>
            <input type="text" pInputText id="name" [(ngModel)]="account.User_Name" required autofocus />
            <small class="p-error" *ngIf="submitted && !account.User_Name">اسم المستخدم مطلوب</small>
        </div>
        <div class="field">
            <label for="name">كلمة المرور</label>
            <input type="text" pInputText id="name" [(ngModel)]="account.User_Password" required autofocus />
            <small class="p-error" *ngIf="submitted && !account.User_Password">كلمة السر مطلوبة</small>
        </div>
        <div class="field">
            <label for="name">رقم الجامعة</label>
            <input type="text" pInputText id="name" [(ngModel)]="account.Collage_FK" />
        </div>
        <div class="field">
            <label for="name">نوع المستخدم</label>
            <input type="text" pInputText id="name" [(ngModel)]="account.User_Type" required autofocus />
            <small class="p-error" *ngIf="submitted && !account.User_Type">نوع المستخدم مطلوب</small>
        </div>
    </ng-template>

    <ng-template pTemplate="footer">
        <button pButton pRipple label="الغاء" icon="pi pi-times" class="p-button-text" (click)="hideDialog()"></button>
        <button pButton pRipple label="حفظ" icon="pi pi-check" class="p-button-text" (click)="saveAccount()"></button>
    </ng-template>
</p-dialog>

<p-confirmDialog [style]="{ width: '450px' }"></p-confirmDialog>